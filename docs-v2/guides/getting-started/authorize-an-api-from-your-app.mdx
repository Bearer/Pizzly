---
title: 'Authorize users from your app'
sidebarTitle: 'Authorize users from your app'
description: 'Step-by-step guide on getting user authorization to access an external API, from your application.'
---

<Info>
Pre-requisite: completion of the [_Configure an integration_ guide](/guides/getting-started/configure-an-integration).
</Info>

Nango Connect requires a unique temporary token to securely authenticate your users.

<img src="/images/connect-ui/steps.png" alt="Nango Connect UI required steps" />

<Tip>You can check a live implementation in our <a href="https://github.com/NangoHQ/sample-app?rel=connect-ui-guide"> Sample App</a></Tip>

## Step 1: Generate a Session token

To securely authenticate your users, we need a dedicated token generated on your backend and passed to the frontend. This security measure allows us to strictly identify authenticated users and pre-filter allowed integrations.

On **your backend**, you need an API endpoint that your frontend contacts, which will then communicate with the Nango API. Once you get back the token, forward it to Nango Connect.
This token has a lifespan of 30 minutes after which it expires.

```javascript
import { Nango } from '@nangohq/node';

const nango = new Nango({ secretKey: process.env['NANGO_SECRET_KEY'] });

api.post('/sessionToken', (req, res) => {
  // Ask Nango for a secure token
  const res = await nango.createConnectSession({
    end_user: {
      id: user.id,
      email: user.email,
      display_name: user.displayName,
    },
    allowed_integrations: ['bamboohr'],
  });

  // Send this token back to your frontend
  res.status(200).send({
    sessionToken: res.data.token
  });
});
```

<Card title="POST /connect/sessions" icon="code" href="/reference/api/connect/sessions/create" horizontal>
  Not using the SDK? Check our HTTP API reference
</Card>

## Step 2: Trigger Auth Flow

In **your frontend**, you need to load our SDK, get the Session Token from Step 1 and open Nango Connect

```js
import Nango from '@nangohq/frontend';

const nango = new Nango();
const connect = nango.openConnectUI();

// Call the endpoint created in Step 1
const res = await fetch('/sessionToken', { method: 'POST' });
connect.setSessionToken(res.sessionToken);
```

<Tip>It's recommended to set the `sessionToken` asynchronously to be able to display the UI loading to your users before it's ready for better UX</Tip>

## Step 3: Link Connection ID to your user

In **your frontend**, the Connect UI will send back an event when a user connects or closes the modal. You can register an event listener and respond appropriately.

When a user completes a flow, you will receive a `connect` event. This event contains the `providerConfigKey`, which is the id of your integration and a `connectionId`, which is the auto-generated id that represents the couple user + integration.

```js
[...]

function saveConnectionId(authResults) {
  await fetch('/connection', { method: 'POST', body: authResults });
}

nango.openConnectUI({
  sessionToken: await getSessionToken(),

  // Listen to events
  onEvent: (event) => {
    if (event.type === 'connect') {
      void saveConnectionId(event.payload);
    }
  },
});
```

In your backend, associate this connectionId to your end user.

```javascript
api.post('/connection', (req, res) => {
  await User.update({
    connectionId: req.body.connectionId,
    integrationId: req.body.providerConfigKey,
  });

  res.status(200).send({
    success: true
  });
});
```

<Tip>If you have multiple integrations you will have to store multiple `connectionId`s</Tip>

## Listen for webhooks

Your backend is notified by Nango when an authorization attempt is completed, successful or not.

To set this up:
1. go to the _Environment Settings_ tab
2. specify a _Webhook URL_ to which Nango will send notifications
3. listen for webhooks in your backend at the specified route
4. enable the "Send New Connection Creation Webhooks" checkbox

Nango webhooks are post requests with the following JSON body:
```json
{
    "type": "auth",
    "connectionId": "<CONNECTION-ID>",
    "authMode": "OAUTH1|OAUTH2|OAUTH2_CC|BASIC|API_KEY|APP_STORE|CUSTOM|APP|NONE|TBA",
    "providerConfigKey": "<INTEGRATION-ID>",
    "provider": "<API-CONFIGURATION-ID>",
    "environment": "dev" | "prod",
    "success": true | false,
    "operation": "creation" | "override" | "unknown",
    "error": "<ERROR>"
}
```

For each successful authorization attempt, persist the connection ID & integration ID in your database. You will need them to retrieve the connection credentials later.

<Info>
Before using Nango in production, we advise [verifying webhook signatures](/guides/verify-webhooks-from-nango).
</Info>

# You are ready

Your users can now launch Nango Connect and connect to any of your integrations, Nango is taking care of the rest.


<Card title="Want to build your own UI?" icon="code" href="/guides/authorize-an-api-from-your-app-with-custom-ui" horizontal>
  Use the Headless API to create your custom experience
</Card>


<Tip>
**Questions, problems, feedback?** Please reach out in the [Slack community](https://nango.dev/slack).
</Tip>
